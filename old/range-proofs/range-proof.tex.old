We construct a NIZK proof of membership in the language
$$
\Lang_{[0,2^n-1],\hmatr{U}} := \{\hvecb{c}\in\Gr^2: \exists x,r\in\Z_q\text{ s.t. }\hvecb{c}=x\hvecb{u}_1+r\hvecb{u}_2\wedge x\in[0,2^n-1]\}
$$

\begin{description}

\item[$\algK_0(1^\lambda)$:]  Return $\Gamma := (q,\Gr,\Hr,\T,e,\hat{g},\check{h}) \leftarrow \ggen_a(1^{\lambda})$.

\item[$\dist_\Gamma$:] The distribution $\dist_\Gamma$ over $\N\times\Gr^{2\times 2}$ is some witness samplable distribution which defines the relation $\R_\Gamma = \{\R_{n,\hmatr{U}}\} \subseteq \Gr^2\times(\Z_q^2)$,
where $(n,\hmatr{U})\gets\dist_\Gamma$,
such that $(\hvecb{c},\langle x,r\rangle)\in\R_{n,\hmatr{U}}$ iff
$\hvecb{c}=x\hvecb{u}_1+r\hvecb{u}_2$ and $\hat{x} \in [0,2^n-1]$. The relation $\R_{par}$ consists of pairs $(\hmatr{U},\matr{U})$ where $(n,\hmatr{U}) \gets \dist_{\Gamma}$.
\item[$\algK_1(\Gamma, (n,\hmatr{U}),k)$:]
Define $m=k\log n$. Let $\Psi_\sfbits$ the proof system described in XXX and let $\crs_\sfbits:=(\Lck,\Rck,\crs'_\sfbits)\gets\Psi_\sfbits.\algK_1(\Gamma,m)$. For each $i\in[n/m+1]$ denote by $\rck_i$ the $i$ th column of $\Rck$.

The common reference string is given by $\mathsf{crs} := (n,m,k,\hmatr{U},\crs_\sfbits)$

\item[$\algP(\mathsf{crs}, \hvecb{c}, \langle x,r \rangle)$:] Let $\matr{B}\in\bits^{(n/m)\times m}$ such that
$$
x = \sum_{i\in[n/m]}\sum_{j\in[m]}b_{i,j}2^{m(i-1)+j-1}.
$$
That is, $\matr{B}$ is the binary representation of $x$ arranged in a matrix of size $(m/n)\times m$.
\begin{enumerate}
\item For each $i\in[m]$ compute $x_i=\sum_{j\in[m]}b_{i,j}2^{j-1}$ and commit to $x_i$ as $\hvecb{c}_i := x_i\hvecb{u}_1+s_i\hvecb{u}_2$, where $s_i\gets\Z_q$.

\item For each $j\in[m]$ compute $(\hgrkb{\alpha}_j,\cgrkb{\beta}_j,\pi'_j)\gets\Psi_\sfbits.\algP(\crs_\sfbits,(b_{1,j},\ldots,b_{m,j})^\top)$. (Recall that $\cgrkb{\beta}_j = \sum_{i\in[m]}b_{i,j}\rck_i+t_j\rck_{m+1}$ for $t_j\gets\Z_q$.)

\item Pick $s_{m+1}\gets\Z_q$ and compute $\cgrkb{\pi}:=\sum_{i\in[m+1]}s_i\rck_i$ and $\hgrkb{\theta}:=\left(\sum_{j\in[m]}t_j2^{j-1}\right)\hvecb{u}_1-s_{m+1}\hvecb{u}_2$.

\item Compute $\rho := r-\sum_{i\in[m]}s_i2^{m(i-1)}$.

Finally, return the proof $(\{\hvecb{c}_i,(\hgrkb{\alpha}_i,\cgrkb{\beta}_i,\pi'_i):i\in[m]\},\cgrkb{\pi},\hgrkb{\theta},\rho)$.
\end{enumerate}

\item[
${\algV(
    \crs,
    \hvecb{c},
    (
        \{\hvecb{c}_i,(\hgrkb{\alpha}_i,\cgrkb{\beta}_i,\pi'_i):i\in[m]\},\cgrkb{\pi},\hgrkb{\theta},\rho
    ))}$
]:
\hfill\\
%   
\begin{enumerate}
\item For all $j\in[n]$, check if $\Psi_\sfbits.\algV(\crs_\sfbits, (\hgrkb{\alpha}_j,\cgrkb{\beta}_j,\pi'_j))=1$. 
\item Check if $\sum_{i\in[m]}\hvecb{c}_i\rck_i^\top-\hvecb{u}_1\left(\sum_{j\in[n]}\cgrkb{\beta}_j2^{j-1}\right)^\top = \hvecb{u}_2\cgrkb{\pi}^\top+\hgrkb{\theta}\rck_{m+1}^\top$.
\item Check if $\hvecb{c}-\sum_{i\in[m]}\hvecb{c}_i2^{m(i-1)}=\rho\hvecb{u}_2$.
\end{enumerate}
If any of these checks fails, the verifier outputs $0$, else it outputs $1$.

%\item[$\mathsf{S}_1(\Gamma,(n,\hat{\matr{U}}),k)$:] The simulator receives as input a description of an asymmetric bilinear group $\Gamma$ and  $(n,\hat{\matr{U}})$ sampled according to distribution $\dist_{\Gamma}$. It generates and outputs the CRS in the same way as $\algK_1$, but additionally it also  outputs the simulation trapdoor 
%$$\tau=\left(\epsilon_1,\ldots,\epsilon_m, \tau_\QANIZKsum, \tau_\QANIZKcomms, \tau_\Phi\right),$$
%where $\tau_\QANIZKsum$, $\tau_\QANIZKcomms$, and $\tau_\Phi$ are $\QANIZKsum$'s, $\QANIZKcomms$'s, and $\Phi$'s simulation trapdoors, respectively, and
%$\rck_i=\epsilon_i\rck_{m+1}$ for each $i\in[m]$.
%\item[$\mathsf{S}_2(\crs,(\vc_1,\ldots,\vc_m),\tau)$:] 
%      For each $j\in[n]$ compute $\pi_j\gets\Psi_\sfbits.\algP(\crs_\sfbits,\vecb{0}_{n\times1})$, that is, pick random $w_{g,j},w_{h,j} \gets \Z_q$  $\matr{R} \gets \Z_q^{2 \times 2}$ and define:
%\begin{align*}
%&\hgrkb{\alpha}_j := w_{g,j}\lck_{m+1}& &\cgrkb{\beta}_j := w_{h,j}\rck_{m+1}\\
%&\hmatr{\Theta}_{b(\overline{b}-1),j} :=  w_{g,j}w_{h,j}\hmatr{C}_{m+1,m+1}+\hmatr{R}& 
%&\cmatr{\Pi}_{b(\overline{b}-1),j} := w_{g,j}w_{h,j}\cmatr{D}_{m+1,m+1}- \cmatr{R}.
%\end{align*}
%Simulate proofs $(\hat{\boldsymbol \rho}_{X},
%  \check{\boldsymbol \sigma}_{X})$,
%for $X \in \{b(\overline{b}-1),  b-\overline{b}\}$, and
%$\check{\phi}$  using $\tau_\QANIZKsum$, $\tau_\QANIZKcomms$, and $\tau_\Phi$.\footnote{Actually, the proofs can be computed honestly since the witness for each of the three statements are known.}
%Finally, pick $\overline{\vecb{r}}\gets\Z_q^2$ and compute proofs
%\begin{align*}
%&\cmatr{\Pi}:=\overline{\vecb{r}}\rck_{m+1}^\top,& &\cgrkb{\theta}:=\sum_{i\in[m]}\epsilon_i\hvecb{c}_i-\sum_{j\in[n]}w_{h,j}\iota_1(\hat{l}_j)-\hmatr{U}\overline{\vecb{r}}.
%\end{align*}
\end{description}

